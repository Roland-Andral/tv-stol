<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>TV STOL</title>
  <style>
    html, body { margin:0; padding:0; width:100%; height:100%; background:black; overflow:hidden; display:flex; justify-content:center; align-items:center; color:white; font-family:sans-serif; }
    iframe { border:none; width:100%; height:100%; }
    #message { font-size:48px; text-align:center; }
  </style>
</head>
<body>
  <div id="message">Bienvenue sur la TV STOL</div>
  <script>
    const URL_TV = "https://script.google.com/macros/s/AKfycbxMDhy5zzsjEJ2XO6PDXVHGALbbaAYOHTKwNVb934A5eSB6NTYSgIjoBWBdt32TDXGn0w/exec";

    async function majTV() {
      try {
        const resp = await fetch(URL_TV);
        const data = await resp.json();
        if(data.type==="message"){
          const val = data.value;
          const container = document.getElementById("message");

          if(/^https?:\/\//i.test(val)){
            container.innerHTML = "";
            const iframe = document.createElement("iframe");
            iframe.src = val + "?rand=" + new Date().getTime();
            container.appendChild(iframe);
          } else {
            container.textContent = val;
          }
        }
      } catch(err){
        console.error("Erreur fetch TV:", err);
        document.getElementById("message").textContent="Erreur récupération TV";
      }
    }

    setInterval(majTV, 2000);
    majTV();
  </script>
</body>
</html>
