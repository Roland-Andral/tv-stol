<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>TV STOL – Affichage</title>

<style>
    body {
        margin: 0;
        background: black;
        font-family: Arial, sans-serif;
        overflow: hidden;
        color: white;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
    }
    iframe {
        border: none;
        width: 100vw;
        height: 100vh;
    }
    #message {
        font-size: 4vw;
        text-align: center;
        padding: 20px;
    }
</style>

<script>
    /*
     * TV CONNECTÉE POUR STOL
     *
     * Ce script lit un petit fichier JSON généré depuis Google Sheets
     * (ou modifiable manuellement) et affiche :
     * - une URL (YouTube, Slides, Sheets…)
     * - ou un message plein écran
     * 
     * Exemple de fichier JSON attendu :
     * {
     *   "type": "url",
     *   "value": "https://google.com"
     * }
     * 
     * ou :
     * {
     *   "type": "message",
     *   "value": "Pause déjeuner"
     * }
     */

    async function refreshDisplay() {
        try {
            // Chemin vers le fichier JSON dans ton GitHub Pages
            //const res = await fetch('display.json?cache=' + Date.now());
              const res = await fetch('https://script.google.com/macros/s/AKfycbzETiWv_Vy_GB_dkXZtKm9pkvcDl7uRIBj8ilzMMRkjWEczZlmOZ-5WRnlltC9DsDL9RA/exec?cache=' + Date.now());
            const data = await res.json();

            if (data.type === "url") {
                document.getElementById("msgContainer").style.display = "none";
                document.getElementById("frame").style.display = "block";
                document.getElementById("frame").src = data.value;
            }

            if (data.type === "message") {
                document.getElementById("frame").style.display = "none";
                document.getElementById("msgContainer").style.display = "flex";
                document.getElementById("message").innerText = data.value;
            }

        } catch (err) {
            console.log("Erreur chargement display.json :", err);
        }
    }

    // Rafraîchir toutes les 10 secondes
    setInterval(refreshDisplay, 10000);

    // Premier affichage
    window.onload = refreshDisplay;
</script>

</head>

<body>

    <!-- Affichage texte -->
    <div id="msgContainer" style="display:none;">
        <div id="message">Chargement…</div>
    </div>

    <!-- Affichage URL -->
    <iframe id="frame" src=""></iframe>

</body>
</html>


