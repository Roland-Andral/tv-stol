<script>
const URL =
 "https://docs.google.com/spreadsheets/d/1RAIdAw_wSAK7kyFPCYjGqX5bCzS1e2n3lTRf2Tkrz5k/gviz/tq?tqx=out:json&sheet=Affichage";

let currentMode = "";

function refresh() {
  fetch(URL)
    .then(r => r.text())
    .then(t => {
      const json = JSON.parse(t.substring(47).slice(0, -2));
      const rows = json.table.rows;

      const mode = rows[0].c[0]?.v || "MESSAGE";

      if (mode === currentMode) return;
      currentMode = mode;

      if (mode === "MESSAGE") {
        document.body.innerHTML =
          `<h1 style="color:white">${rows[0].c[1]?.v || ""}</h1>`;
      }

      if (mode === "YOUTUBE") {
        window.location.replace(rows[1].c[1]?.v);
      }

      if (mode === "SLIDES") {
        window.location.replace(rows[2].c[1]?.v);
      }
    });
}

refresh();
setInterval(refresh, 2000);
</script>
